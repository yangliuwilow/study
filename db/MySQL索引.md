# MySQL索引



### **一、MySQL 引擎区别**

myisam: 插入少，查询多，不支持事物，

innodb:  插入多，查询少，支持事物，



> **1、存储空间**

 MyISAM：可被压缩，存储空间较小。

 InnoDB：需要更多的内存和存储，它会在主内存中建立其专用的缓冲池用于高速缓冲数据和索引。  MyISAM的索引和数据是分开的，并且索引是有压缩的，内存使用率就对应提高了不少。能加载更多索引，而Innodb是索引和数据是紧密捆绑的，没有使用压缩从而会造成Innodb比MyISAM体积庞大不小 

**myisam:   存储文件**   （非聚集索引）

- ​     .myi 索引文件

- ​    .myd  数据文件

- ​    .frm  表结构文件

**innodb**      :存储文件（聚集索引）

- ​     .frm  表结构文件

- ​     .idb   索引和数据文件

  

**执行顺序** select*from  table_name  where id = ?   ; myisam  引擎先查询**.myi** 索引文件再查找**.myd** 数据文件

​              .

> **2、事务处理** 

 MyISAM类型的表强调的是性能，其执行数度比InnoDB类型更快，但是不支持外键、不提供事务支持。

 InnoDB提供事务支持事务，外部键（foreign key）等高级[数据库](http://lib.csdn.net/base/mysql)功能。 

> **3、表的具体行数**

 MyISAM：保存有表的总行数，如果select count(*) from table;会直接取出该值。  

InnoDB：没有保存表的总行数，如果使用select count(*) from table；就会遍历整个表，消耗相当大，但是在加了where后，myisam和innodb处理的方式都一样。 

> **4、表锁差异**

 MyISAM：只支持表级锁，只支持表级锁，用户在操作myisam表时，select，update，delete，insert语句都会给表自动加锁。 

 InnoDB：支持事务和行级锁，是innodb的最大特色。行锁大幅度提高了多用户并发操作的新能。但是InnoDB的行锁也不是绝对的，如果在执行一个SQL语句时[MySQL](http://lib.csdn.net/base/mysql)不能确定要扫描的范围，InnoDB表同样会锁全表， 例如update table set num=1 where name like “%aaa%” 

### 二、MySQL索引类型

 btree索引和hash索引



**2.1 Btree索引：balance tree**

> （1）所有非叶子结点**至多拥有两个儿子**（Left和Right）；

> （2）所有结点存储**一个关键字**；

> （3）非叶子结点的左指针指向小于其关键字的子树，右指针指向大于其关键字的子树；（简单说，**左边比自己小，右边比自己大**）





**聚集索引和非聚集索引区别**

聚集索引 ：数据和索引分开存储，先在索引文件查找，然后再根据查找内容去数据文件查找。一个表中只能有一个聚集索引，多个索引的情况，在创建一个非聚集索引

非聚集索引 ：直接去idb    去查找，

![1531140938585](..\images\mysql-index.png)

**索引的优缺点**

**优点：** 提高检索速度（降低磁盘的读取IO）

​            索引是排好序的，降低数据运算成本，从而降低了CPU的消耗；

**缺点：**   索引也需要存储，占用额外的存储空间

​              如果索引建立在更新频繁的字段上面，会存在很大的性能损耗，更新（增删改）索引数据，不只是更新数据，还需要更新索引信息，

**不合适建索引的数据**：

​         频繁更新的字段，where 条件用不到的字段，字段重复值多（男女，0,1），参与列计算的不合适索引,范围查询例如： age>12 ,

**合适建索引的列：**

​        where查询多的，关联字段，排序字段，分组字段，统计字段



